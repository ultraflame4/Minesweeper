window.addEventListener("load",(function(){document.getElementById("openGeneratePopup").addEventListener("click",(function(){document.getElementById("generateConfigContainer").style.display="flex"})),document.getElementById("closeConfigButton").addEventListener("click",(function(){document.getElementById("generateConfigContainer").style.display="none"}));var e=!1,t=0,n=0,a=0;function d(e,n){void 0===n&&(n=!1);for(var a=0,o=!1,i=parseInt(e.dataset.y),l=parseInt(e.dataset.x),r=!1,s=0;s<3;s++)for(var c=s-1+i,u=0;u<3;u++){var m="fieldTileId-"+(u-1+l)+"x"+c,f=document.getElementById(m);null!=f&&(n&&("true"===f.dataset.isbomb&&(f.dataset.isbomb="false",t--,r=!0),d(f),f.disabled=!0),"true"===f.dataset.isbomb&&a++)}return e.textContent=a.toString(),"true"==e.dataset.isbomb&&(e.textContent="X",o=!0),r?d(e,n):o}function o(){console.log("Exposing field...");var e=document.getElementById("minefieldContainer");Array.from(e.children).forEach((function(e){Array.from(e.children).forEach((function(e){d(e),e.disabled=!0}))}))}function i(){n>=t&&a==n&&(console.log(n,t),o(),setTimeout((function(){alert("Congratulations!\nYou have successfuly uncovered all mines.\nClick generate to create a new game")}),400))}document.getElementById("generateField").addEventListener("click",(function(){t=0,n=0,a=0,e=!0;var l=parseInt(document.getElementById("fieldHeightInput").value),r=parseInt(document.getElementById("fieldWidthInput").value),s=document.getElementById("minefieldContainer");s.innerHTML="";for(var c=0;c<l;c++){var u=document.createElement("div");u.className="row";for(var m=function(l){var r=document.createElement("button");r.id="fieldTileId-"+l+"x"+c,r.dataset.x=l.toString(),r.dataset.y=c.toString(),r.className="fieldTile",r.addEventListener("contextmenu",(function(t){var d;t.preventDefault(),(d=r).disabled||e||("true"===d.dataset.isflagged?(d.dataset.isflagged="false",d.textContent="",a--):(d.dataset.isflagged="true",d.textContent="F",a++,"true"===d.dataset.isbomb&&(n++,document.getElementById("checkFlag").checked&&(d.textContent="B"))),i())})),r.addEventListener("click",(function(t){var a;"true"!==(a=r).dataset.isflagged&&(d(a,e)&&!e&&(n++,setTimeout((function(){confirm("Boom! Dead.\nYou stepped on a landmine and exploded.\nDo you want to continue? \n(Click OK to resume game and CANCEL to quit)")||o()}),400)),e=!1,a.disabled=!0,i())}));var s=Math.random()<.25;s&&(r.dataset.isbomb=s.toString(),t++),r.dataset.isflagged="false",u.append(r)},f=0;f<r;f++)m(f);s.append(u)}document.getElementById("closeConfigButton").click()}))}));